<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lenny Budlinger">
<meta name="author" content="Thomas van der Wardt">
<meta name="author" content="Oliver Zingg">

<title>Project Title</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="main_files/libs/clipboard/clipboard.min.js"></script>
<script src="main_files/libs/quarto-html/quarto.js"></script>
<script src="main_files/libs/quarto-html/popper.min.js"></script>
<script src="main_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="main_files/libs/quarto-html/anchor.min.js"></script>
<link href="main_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="main_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="main_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="main_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="main_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#packages" id="toc-packages" class="nav-link active" data-scroll-target="#packages">Packages</a></li>
  <li><a href="#load" id="toc-load" class="nav-link" data-scroll-target="#load">Load</a></li>
  <li><a href="#description-of-the-lga-data-set" id="toc-description-of-the-lga-data-set" class="nav-link" data-scroll-target="#description-of-the-lga-data-set">Description of the LGA Data set</a>
  <ul class="collapse">
  <li><a href="#total-flights-and-delays" id="toc-total-flights-and-delays" class="nav-link" data-scroll-target="#total-flights-and-delays">Total Flights and Delays</a></li>
  <li><a href="#depature-times" id="toc-depature-times" class="nav-link" data-scroll-target="#depature-times">Depature times</a></li>
  <li><a href="#arrival-delay-by-day-and-season" id="toc-arrival-delay-by-day-and-season" class="nav-link" data-scroll-target="#arrival-delay-by-day-and-season">Arrival Delay by Day and Season</a></li>
  </ul></li>
  <li><a href="#linear-model" id="toc-linear-model" class="nav-link" data-scroll-target="#linear-model">Linear Model</a>
  <ul class="collapse">
  <li><a href="#post-hoc-tests" id="toc-post-hoc-tests" class="nav-link" data-scroll-target="#post-hoc-tests">Post-Hoc Tests</a></li>
  <li><a href="#interpretation-of-final-model" id="toc-interpretation-of-final-model" class="nav-link" data-scroll-target="#interpretation-of-final-model">Interpretation of final model</a>
  <ul class="collapse">
  <li><a href="#coefficients-of-model" id="toc-coefficients-of-model" class="nav-link" data-scroll-target="#coefficients-of-model">Coefficients of Model</a></li>
  <li><a href="#lets-explore-our-model-variables-a-bit-more" id="toc-lets-explore-our-model-variables-a-bit-more" class="nav-link" data-scroll-target="#lets-explore-our-model-variables-a-bit-more">Let’s explore our model variables a bit more</a></li>
  <li><a href="#model-diagnostics" id="toc-model-diagnostics" class="nav-link" data-scroll-target="#model-diagnostics">Model diagnostics</a></li>
  <li><a href="#lets-look-at-density-plots" id="toc-lets-look-at-density-plots" class="nav-link" data-scroll-target="#lets-look-at-density-plots">Let’s look at density plots</a></li>
  <li><a href="#transformation" id="toc-transformation" class="nav-link" data-scroll-target="#transformation">Transformation</a></li>
  <li><a href="#z-normalization" id="toc-z-normalization" class="nav-link" data-scroll-target="#z-normalization">z-normalization</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#glm-poisson" id="toc-glm-poisson" class="nav-link" data-scroll-target="#glm-poisson">GLM Poisson</a></li>
  <li><a href="#glm-binomial" id="toc-glm-binomial" class="nav-link" data-scroll-target="#glm-binomial">GLM Binomial</a>
  <ul class="collapse">
  <li><a href="#percentage-of-flights-with-more-than-180-minutes-delay" id="toc-percentage-of-flights-with-more-than-180-minutes-delay" class="nav-link" data-scroll-target="#percentage-of-flights-with-more-than-180-minutes-delay">Percentage of flights with more than 180 minutes delay</a>
  <ul class="collapse">
  <li><a href="#aggregated-data" id="toc-aggregated-data" class="nav-link" data-scroll-target="#aggregated-data">Aggregated Data</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#neural-network" id="toc-neural-network" class="nav-link" data-scroll-target="#neural-network">Neural Network</a></li>
  <li><a href="#support-vector-machine" id="toc-support-vector-machine" class="nav-link" data-scroll-target="#support-vector-machine">Support Vector Machine</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Project Title</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Lenny Budlinger </p>
             <p>Thomas van der Wardt </p>
             <p>Oliver Zingg </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>

<nav id="TOC-body" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#packages" id="toc-packages">Packages</a></li>
  <li><a href="#load" id="toc-load">Load</a></li>
  <li><a href="#description-of-the-lga-data-set" id="toc-description-of-the-lga-data-set">Description of the LGA Data set</a>
  <ul>
  <li><a href="#total-flights-and-delays" id="toc-total-flights-and-delays">Total Flights and Delays</a></li>
  <li><a href="#depature-times" id="toc-depature-times">Depature times</a></li>
  <li><a href="#arrival-delay-by-day-and-season" id="toc-arrival-delay-by-day-and-season">Arrival Delay by Day and Season</a></li>
  </ul></li>
  <li><a href="#linear-model" id="toc-linear-model">Linear Model</a>
  <ul>
  <li><a href="#post-hoc-tests" id="toc-post-hoc-tests">Post-Hoc Tests</a></li>
  <li><a href="#interpretation-of-final-model" id="toc-interpretation-of-final-model">Interpretation of final model</a>
  <ul>
  <li><a href="#coefficients-of-model" id="toc-coefficients-of-model">Coefficients of Model</a></li>
  <li><a href="#lets-explore-our-model-variables-a-bit-more" id="toc-lets-explore-our-model-variables-a-bit-more">Let’s explore our model variables a bit more</a></li>
  <li><a href="#model-diagnostics" id="toc-model-diagnostics">Model diagnostics</a></li>
  <li><a href="#lets-look-at-density-plots" id="toc-lets-look-at-density-plots">Let’s look at density plots</a></li>
  <li><a href="#transformation" id="toc-transformation">Transformation</a></li>
  <li><a href="#z-normalization" id="toc-z-normalization">z-normalization</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#glm-poisson" id="toc-glm-poisson">GLM Poisson</a></li>
  <li><a href="#glm-binomial" id="toc-glm-binomial">GLM Binomial</a>
  <ul>
  <li><a href="#percentage-of-flights-with-more-than-180-minutes-delay" id="toc-percentage-of-flights-with-more-than-180-minutes-delay">Percentage of flights with more than 180 minutes delay</a>
  <ul>
  <li><a href="#aggregated-data" id="toc-aggregated-data">Aggregated Data</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#neural-network" id="toc-neural-network">Neural Network</a></li>
  <li><a href="#support-vector-machine" id="toc-support-vector-machine">Support Vector Machine</a></li>
  </ul>
</nav>
<section id="packages" class="level2">
<h2 class="anchored" data-anchor-id="packages">Packages</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Scientific notation</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">999</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># Load packages -----------------------------</span></span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(tidyverse) <span class="co"># ggplot for plotting, dplyr for data manipulation</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(lubridate) <span class="co"># package for handling time variable</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">library</span>(hms) <span class="co"># handling time</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">library</span>(gt) <span class="co"># Print tables</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="fu">library</span>(DT)</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="fu">library</span>(forcats) <span class="co"># Reorder factor levels</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="fu">library</span>(multcomp) <span class="co"># Multiple comparison tests</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="fu">library</span>(patchwork) <span class="co">#plots side by side</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="load" class="level2">
<h2 class="anchored" data-anchor-id="load">Load</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Load data ---------------------------</span></span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co"># get working directory if csv not loading or use absolute path</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># getwd() </span></span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="fu">load</span>(<span class="st">"./../Data/LGA_preprocessed.rda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="description-of-the-lga-data-set" class="level2">
<h2 class="anchored" data-anchor-id="description-of-the-lga-data-set">Description of the LGA Data set</h2>
<section id="total-flights-and-delays" class="level3">
<h3 class="anchored" data-anchor-id="total-flights-and-delays">Total Flights and Delays</h3>
<p>For the following table we defined a flight as delayed if the arrival or departure delay is greater than 30 minutes.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Create table</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>planes <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="fu">mutate</span>(<span class="at">index_late_arr =</span> <span class="fu">ifelse</span>(ARR_DELAY <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb3-4"><a href="#cb3-4"></a>         <span class="at">index_late_dep =</span> <span class="fu">ifelse</span>(DEP_DELAY <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="fu">group_by</span>(OP_CARRIER) <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="fu">summarise</span>(</span>
<span id="cb3-7"><a href="#cb3-7"></a>    <span class="at">Total_flights =</span> <span class="fu">n</span>(),</span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="at">Total_delayed_arr =</span> <span class="fu">sum</span>(index_late_arr <span class="sc">==</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-9"><a href="#cb3-9"></a>    <span class="at">percentage_delayed_arr =</span> Total_delayed_arr <span class="sc">/</span> Total_flights <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb3-10"><a href="#cb3-10"></a>    </span>
<span id="cb3-11"><a href="#cb3-11"></a>    <span class="at">Total_delayed_dep =</span> <span class="fu">sum</span>(index_late_dep <span class="sc">==</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-12"><a href="#cb3-12"></a>    <span class="at">percentage_delayed_dep =</span> Total_delayed_dep <span class="sc">/</span> Total_flights <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb3-13"><a href="#cb3-13"></a>    </span>
<span id="cb3-14"><a href="#cb3-14"></a>    <span class="at">median_dep_delay =</span> <span class="fu">median</span>(DEP_DELAY, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-15"><a href="#cb3-15"></a>    <span class="at">median_arr_delay =</span> <span class="fu">median</span>(ARR_DELAY, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb3-16"><a href="#cb3-16"></a>    <span class="at">median_distance =</span> <span class="fu">median</span>(DISTANCE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-17"><a href="#cb3-17"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb3-18"><a href="#cb3-18"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-19"><a href="#cb3-19"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-20"><a href="#cb3-20"></a>    <span class="at">percentage_of_total =</span> Total_flights <span class="sc">/</span> <span class="fu">sum</span>(Total_flights) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb3-21"><a href="#cb3-21"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb3-22"><a href="#cb3-22"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.double), <span class="sc">~</span><span class="fu">round</span>(.x, <span class="dv">2</span>))) <span class="sc">%&gt;%</span> </span>
<span id="cb3-23"><a href="#cb3-23"></a>  <span class="fu">relocate</span>(percentage_of_total, <span class="at">.after =</span> Total_flights)  <span class="sc">%&gt;%</span> </span>
<span id="cb3-24"><a href="#cb3-24"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Total_flights)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-25"><a href="#cb3-25"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-26"><a href="#cb3-26"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb3-27"><a href="#cb3-27"></a>    <span class="at">table.font.size =</span> <span class="fu">px</span>(<span class="dv">8</span>),</span>
<span id="cb3-28"><a href="#cb3-28"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<div id="ekwtqkadus" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ekwtqkadus table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ekwtqkadus thead, #ekwtqkadus tbody, #ekwtqkadus tfoot, #ekwtqkadus tr, #ekwtqkadus td, #ekwtqkadus th {
  border-style: none;
}

#ekwtqkadus p {
  margin: 0;
  padding: 0;
}

#ekwtqkadus .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 8px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ekwtqkadus .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ekwtqkadus .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ekwtqkadus .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ekwtqkadus .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ekwtqkadus .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ekwtqkadus .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ekwtqkadus .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ekwtqkadus .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ekwtqkadus .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ekwtqkadus .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ekwtqkadus .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ekwtqkadus .gt_spanner_row {
  border-bottom-style: hidden;
}

#ekwtqkadus .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ekwtqkadus .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ekwtqkadus .gt_from_md > :first-child {
  margin-top: 0;
}

#ekwtqkadus .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ekwtqkadus .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ekwtqkadus .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ekwtqkadus .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ekwtqkadus .gt_row_group_first td {
  border-top-width: 2px;
}

#ekwtqkadus .gt_row_group_first th {
  border-top-width: 2px;
}

#ekwtqkadus .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ekwtqkadus .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ekwtqkadus .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ekwtqkadus .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ekwtqkadus .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ekwtqkadus .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ekwtqkadus .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ekwtqkadus .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ekwtqkadus .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ekwtqkadus .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ekwtqkadus .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ekwtqkadus .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ekwtqkadus .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ekwtqkadus .gt_left {
  text-align: left;
}

#ekwtqkadus .gt_center {
  text-align: center;
}

#ekwtqkadus .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ekwtqkadus .gt_font_normal {
  font-weight: normal;
}

#ekwtqkadus .gt_font_bold {
  font-weight: bold;
}

#ekwtqkadus .gt_font_italic {
  font-style: italic;
}

#ekwtqkadus .gt_super {
  font-size: 65%;
}

#ekwtqkadus .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ekwtqkadus .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ekwtqkadus .gt_indent_1 {
  text-indent: 5px;
}

#ekwtqkadus .gt_indent_2 {
  text-indent: 10px;
}

#ekwtqkadus .gt_indent_3 {
  text-indent: 15px;
}

#ekwtqkadus .gt_indent_4 {
  text-indent: 20px;
}

#ekwtqkadus .gt_indent_5 {
  text-indent: 25px;
}

#ekwtqkadus .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ekwtqkadus div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="header gt_col_headings">
<th id="OP_CARRIER" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col">OP_CARRIER</th>
<th id="Total_flights" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Total_flights</th>
<th id="percentage_of_total" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">percentage_of_total</th>
<th id="Total_delayed_arr" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Total_delayed_arr</th>
<th id="percentage_delayed_arr" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">percentage_delayed_arr</th>
<th id="Total_delayed_dep" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">Total_delayed_dep</th>
<th id="percentage_delayed_dep" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">percentage_delayed_dep</th>
<th id="median_dep_delay" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">median_dep_delay</th>
<th id="median_arr_delay" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">median_arr_delay</th>
<th id="median_distance" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" scope="col">median_distance</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="OP_CARRIER">AA</td>
<td class="gt_row gt_right" headers="Total_flights">16968</td>
<td class="gt_row gt_right" headers="percentage_of_total">16.91</td>
<td class="gt_row gt_right" headers="Total_delayed_arr">2086</td>
<td class="gt_row gt_right" headers="percentage_delayed_arr">12.29</td>
<td class="gt_row gt_right" headers="Total_delayed_dep">1769</td>
<td class="gt_row gt_right" headers="percentage_delayed_dep">10.43</td>
<td class="gt_row gt_right" headers="median_dep_delay">-3</td>
<td class="gt_row gt_right" headers="median_arr_delay">-8</td>
<td class="gt_row gt_right" headers="median_distance">1097</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="OP_CARRIER">DL</td>
<td class="gt_row gt_right" headers="Total_flights">14455</td>
<td class="gt_row gt_right" headers="percentage_of_total">14.41</td>
<td class="gt_row gt_right" headers="Total_delayed_arr">1618</td>
<td class="gt_row gt_right" headers="percentage_delayed_arr">11.19</td>
<td class="gt_row gt_right" headers="Total_delayed_dep">1359</td>
<td class="gt_row gt_right" headers="percentage_delayed_dep">9.40</td>
<td class="gt_row gt_right" headers="median_dep_delay">-2</td>
<td class="gt_row gt_right" headers="median_arr_delay">-7</td>
<td class="gt_row gt_right" headers="median_distance">761</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="OP_CARRIER">US</td>
<td class="gt_row gt_right" headers="Total_flights">12774</td>
<td class="gt_row gt_right" headers="percentage_of_total">12.73</td>
<td class="gt_row gt_right" headers="Total_delayed_arr">889</td>
<td class="gt_row gt_right" headers="percentage_delayed_arr">6.96</td>
<td class="gt_row gt_right" headers="Total_delayed_dep">580</td>
<td class="gt_row gt_right" headers="percentage_delayed_dep">4.54</td>
<td class="gt_row gt_right" headers="median_dep_delay">-6</td>
<td class="gt_row gt_right" headers="median_arr_delay">-10</td>
<td class="gt_row gt_right" headers="median_distance">214</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="OP_CARRIER">MQ</td>
<td class="gt_row gt_right" headers="Total_flights">11298</td>
<td class="gt_row gt_right" headers="percentage_of_total">11.26</td>
<td class="gt_row gt_right" headers="Total_delayed_arr">1368</td>
<td class="gt_row gt_right" headers="percentage_delayed_arr">12.11</td>
<td class="gt_row gt_right" headers="Total_delayed_dep">1243</td>
<td class="gt_row gt_right" headers="percentage_delayed_dep">11.00</td>
<td class="gt_row gt_right" headers="median_dep_delay">-4</td>
<td class="gt_row gt_right" headers="median_arr_delay">-7</td>
<td class="gt_row gt_right" headers="median_distance">431</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="OP_CARRIER">OH</td>
<td class="gt_row gt_right" headers="Total_flights">11162</td>
<td class="gt_row gt_right" headers="percentage_of_total">11.12</td>
<td class="gt_row gt_right" headers="Total_delayed_arr">2018</td>
<td class="gt_row gt_right" headers="percentage_delayed_arr">18.08</td>
<td class="gt_row gt_right" headers="Total_delayed_dep">1796</td>
<td class="gt_row gt_right" headers="percentage_delayed_dep">16.09</td>
<td class="gt_row gt_right" headers="median_dep_delay">0</td>
<td class="gt_row gt_right" headers="median_arr_delay">0</td>
<td class="gt_row gt_right" headers="median_distance">641</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="OP_CARRIER">NW</td>
<td class="gt_row gt_right" headers="Total_flights">8754</td>
<td class="gt_row gt_right" headers="percentage_of_total">8.72</td>
<td class="gt_row gt_right" headers="Total_delayed_arr">1219</td>
<td class="gt_row gt_right" headers="percentage_delayed_arr">13.93</td>
<td class="gt_row gt_right" headers="Total_delayed_dep">1025</td>
<td class="gt_row gt_right" headers="percentage_delayed_dep">11.71</td>
<td class="gt_row gt_right" headers="median_dep_delay">-2</td>
<td class="gt_row gt_right" headers="median_arr_delay">-4</td>
<td class="gt_row gt_right" headers="median_distance">1011</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="OP_CARRIER">UA</td>
<td class="gt_row gt_right" headers="Total_flights">6578</td>
<td class="gt_row gt_right" headers="percentage_of_total">6.56</td>
<td class="gt_row gt_right" headers="Total_delayed_arr">840</td>
<td class="gt_row gt_right" headers="percentage_delayed_arr">12.77</td>
<td class="gt_row gt_right" headers="Total_delayed_dep">858</td>
<td class="gt_row gt_right" headers="percentage_delayed_dep">13.04</td>
<td class="gt_row gt_right" headers="median_dep_delay">-3</td>
<td class="gt_row gt_right" headers="median_arr_delay">-11</td>
<td class="gt_row gt_right" headers="median_distance">733</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="OP_CARRIER">FL</td>
<td class="gt_row gt_right" headers="Total_flights">5954</td>
<td class="gt_row gt_right" headers="percentage_of_total">5.93</td>
<td class="gt_row gt_right" headers="Total_delayed_arr">1001</td>
<td class="gt_row gt_right" headers="percentage_delayed_arr">16.81</td>
<td class="gt_row gt_right" headers="Total_delayed_dep">923</td>
<td class="gt_row gt_right" headers="percentage_delayed_dep">15.50</td>
<td class="gt_row gt_right" headers="median_dep_delay">-4</td>
<td class="gt_row gt_right" headers="median_arr_delay">-5</td>
<td class="gt_row gt_right" headers="median_distance">761</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="OP_CARRIER">CO</td>
<td class="gt_row gt_right" headers="Total_flights">3666</td>
<td class="gt_row gt_right" headers="percentage_of_total">3.65</td>
<td class="gt_row gt_right" headers="Total_delayed_arr">510</td>
<td class="gt_row gt_right" headers="percentage_delayed_arr">13.91</td>
<td class="gt_row gt_right" headers="Total_delayed_dep">436</td>
<td class="gt_row gt_right" headers="percentage_delayed_dep">11.89</td>
<td class="gt_row gt_right" headers="median_dep_delay">-2</td>
<td class="gt_row gt_right" headers="median_arr_delay">-5</td>
<td class="gt_row gt_right" headers="median_distance">1416</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="OP_CARRIER">B6</td>
<td class="gt_row gt_right" headers="Total_flights">2899</td>
<td class="gt_row gt_right" headers="percentage_of_total">2.89</td>
<td class="gt_row gt_right" headers="Total_delayed_arr">530</td>
<td class="gt_row gt_right" headers="percentage_delayed_arr">18.28</td>
<td class="gt_row gt_right" headers="Total_delayed_dep">474</td>
<td class="gt_row gt_right" headers="percentage_delayed_dep">16.35</td>
<td class="gt_row gt_right" headers="median_dep_delay">-2</td>
<td class="gt_row gt_right" headers="median_arr_delay">-3</td>
<td class="gt_row gt_right" headers="median_distance">1076</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="OP_CARRIER">9E</td>
<td class="gt_row gt_right" headers="Total_flights">1547</td>
<td class="gt_row gt_right" headers="percentage_of_total">1.54</td>
<td class="gt_row gt_right" headers="Total_delayed_arr">173</td>
<td class="gt_row gt_right" headers="percentage_delayed_arr">11.18</td>
<td class="gt_row gt_right" headers="Total_delayed_dep">160</td>
<td class="gt_row gt_right" headers="percentage_delayed_dep">10.34</td>
<td class="gt_row gt_right" headers="median_dep_delay">-3</td>
<td class="gt_row gt_right" headers="median_arr_delay">-9</td>
<td class="gt_row gt_right" headers="median_distance">659</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="OP_CARRIER">WN</td>
<td class="gt_row gt_right" headers="Total_flights">1422</td>
<td class="gt_row gt_right" headers="percentage_of_total">1.42</td>
<td class="gt_row gt_right" headers="Total_delayed_arr">206</td>
<td class="gt_row gt_right" headers="percentage_delayed_arr">14.49</td>
<td class="gt_row gt_right" headers="Total_delayed_dep">244</td>
<td class="gt_row gt_right" headers="percentage_delayed_dep">17.16</td>
<td class="gt_row gt_right" headers="median_dep_delay">1</td>
<td class="gt_row gt_right" headers="median_arr_delay">-11</td>
<td class="gt_row gt_right" headers="median_distance">725</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="OP_CARRIER">YV</td>
<td class="gt_row gt_right" headers="Total_flights">1041</td>
<td class="gt_row gt_right" headers="percentage_of_total">1.04</td>
<td class="gt_row gt_right" headers="Total_delayed_arr">149</td>
<td class="gt_row gt_right" headers="percentage_delayed_arr">14.31</td>
<td class="gt_row gt_right" headers="Total_delayed_dep">155</td>
<td class="gt_row gt_right" headers="percentage_delayed_dep">14.89</td>
<td class="gt_row gt_right" headers="median_dep_delay">-3</td>
<td class="gt_row gt_right" headers="median_arr_delay">-9</td>
<td class="gt_row gt_right" headers="median_distance">229</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="OP_CARRIER">XE</td>
<td class="gt_row gt_right" headers="Total_flights">890</td>
<td class="gt_row gt_right" headers="percentage_of_total">0.89</td>
<td class="gt_row gt_right" headers="Total_delayed_arr">135</td>
<td class="gt_row gt_right" headers="percentage_delayed_arr">15.17</td>
<td class="gt_row gt_right" headers="Total_delayed_dep">131</td>
<td class="gt_row gt_right" headers="percentage_delayed_dep">14.72</td>
<td class="gt_row gt_right" headers="median_dep_delay">-6</td>
<td class="gt_row gt_right" headers="median_arr_delay">-11</td>
<td class="gt_row gt_right" headers="median_distance">418</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="OP_CARRIER">F9</td>
<td class="gt_row gt_right" headers="Total_flights">727</td>
<td class="gt_row gt_right" headers="percentage_of_total">0.72</td>
<td class="gt_row gt_right" headers="Total_delayed_arr">110</td>
<td class="gt_row gt_right" headers="percentage_delayed_arr">15.13</td>
<td class="gt_row gt_right" headers="Total_delayed_dep">70</td>
<td class="gt_row gt_right" headers="percentage_delayed_dep">9.63</td>
<td class="gt_row gt_right" headers="median_dep_delay">-3</td>
<td class="gt_row gt_right" headers="median_arr_delay">0</td>
<td class="gt_row gt_right" headers="median_distance">1619</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="OP_CARRIER">EV</td>
<td class="gt_row gt_right" headers="Total_flights">172</td>
<td class="gt_row gt_right" headers="percentage_of_total">0.17</td>
<td class="gt_row gt_right" headers="Total_delayed_arr">21</td>
<td class="gt_row gt_right" headers="percentage_delayed_arr">12.21</td>
<td class="gt_row gt_right" headers="Total_delayed_dep">24</td>
<td class="gt_row gt_right" headers="percentage_delayed_dep">13.95</td>
<td class="gt_row gt_right" headers="median_dep_delay">-2</td>
<td class="gt_row gt_right" headers="median_arr_delay">-9</td>
<td class="gt_row gt_right" headers="median_distance">617</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="OP_CARRIER">OO</td>
<td class="gt_row gt_right" headers="Total_flights">27</td>
<td class="gt_row gt_right" headers="percentage_of_total">0.03</td>
<td class="gt_row gt_right" headers="Total_delayed_arr">7</td>
<td class="gt_row gt_right" headers="percentage_delayed_arr">25.93</td>
<td class="gt_row gt_right" headers="Total_delayed_dep">4</td>
<td class="gt_row gt_right" headers="percentage_delayed_dep">14.81</td>
<td class="gt_row gt_right" headers="median_dep_delay">-1</td>
<td class="gt_row gt_right" headers="median_arr_delay">4</td>
<td class="gt_row gt_right" headers="median_distance">478</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</div>
</section>
<section id="depature-times" class="level3">
<h3 class="anchored" data-anchor-id="depature-times">Depature times</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">#|output: false</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>planes <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="fu">summarise</span>(</span>
<span id="cb4-4"><a href="#cb4-4"></a>    <span class="at">planned_first_flight =</span> <span class="fu">min</span>(CRS_DEP_TIME, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-5"><a href="#cb4-5"></a>    <span class="at">planned_last_flight =</span> <span class="fu">max</span>(CRS_DEP_TIME, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-6"><a href="#cb4-6"></a>    <span class="at">actual_first_flight =</span> <span class="fu">min</span>(DEP_TIME, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb4-7"><a href="#cb4-7"></a>    <span class="at">actual_last_flight =</span> <span class="fu">max</span>(DEP_TIME, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-8"><a href="#cb4-8"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb4-9"><a href="#cb4-9"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 26%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">planned_first_flight</th>
<th style="text-align: right;">planned_last_flight</th>
<th style="text-align: right;">actual_first_flight</th>
<th style="text-align: right;">actual_last_flight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">535</td>
<td style="text-align: right;">2239</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2400</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>If we look at the planned departure times, we see that the first flight is at 5:35 am and the last flight is at 10:39 pm. This departure times are explain by a seasonal curfew between the hours of 12 am and 6 am during the warm months (Source: Wikipedia).</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>planes <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> CRS_DEP_TIME, <span class="at">y =</span> DEP_TIME)) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This plot shows the planned departure time on the x axis and the actual departure time an the y axis. Points on the diagonal departed on time. On the bottom right of the plot we see a few cases of flights that have a delay and depart on the next day early morning. This should be considered when using <code>DEP_TIME</code> in a statistical model. Since flights before 5 am are systematic different from flights after 5 am since these flights were planned to depart the day before.</p>
</section>
<section id="arrival-delay-by-day-and-season" class="level3">
<h3 class="anchored" data-anchor-id="arrival-delay-by-day-and-season">Arrival Delay by Day and Season</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>p1 <span class="ot">&lt;-</span> planes <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">mutate</span>(<span class="at">Weekday =</span> <span class="fu">fct_relevel</span>(Weekday, <span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>, <span class="st">"Saturday"</span>, <span class="st">"Sunday"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> ARR_DELAY)) <span class="sc">+</span> </span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">"red"</span>,<span class="at">outlier.shape =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept  =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>,<span class="at">linetype=</span><span class="st">'dotted'</span>) <span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Weekday)<span class="sc">+</span> </span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb6-9"><a href="#cb6-9"></a></span>
<span id="cb6-10"><a href="#cb6-10"></a>p2 <span class="ot">&lt;-</span> planes <span class="sc">%&gt;%</span> </span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="fu">mutate</span>(<span class="at">Weekday =</span> <span class="fu">fct_relevel</span>(Weekday, <span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>, <span class="st">"Saturday"</span>, <span class="st">"Sunday"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Season, ARR_DELAY)) <span class="sc">+</span> </span>
<span id="cb6-13"><a href="#cb6-13"></a>  <span class="fu">geom_violin</span>() <span class="sc">+</span> </span>
<span id="cb6-14"><a href="#cb6-14"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept  =</span> <span class="dv">0</span>, <span class="at">linetype=</span><span class="st">'dotted'</span>,<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb6-15"><a href="#cb6-15"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Weekday) <span class="sc">+</span> </span>
<span id="cb6-16"><a href="#cb6-16"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">100</span>)) <span class="sc">+</span></span>
<span id="cb6-17"><a href="#cb6-17"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb6-18"><a href="#cb6-18"></a>  </span>
<span id="cb6-19"><a href="#cb6-19"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Arrival Delay are similar across the weekdays and season. On weekends the median of arrival delay seems to be a bit lower. The violin plot give us a feeling of how skewed arrival delay is and how different the median and average are. Other variables in this data set are similarly skewed, therefore modeling the average may not represent the biggest part of the data. We will later see if we can handle this skewness.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>planes <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(DEP_DELAY,ARR_DELAY,CRS_DEP_TIME,WHEELS_OFF,WHEELS_ON, DISTANCE,ACTUAL_ELAPSED_TIME, TAXI_OUT, TAXI_IN ) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">"complete.obs"</span>) <span class="sc">%&gt;%</span> <span class="fu">kable</span>(<span class="at">caption =</span> <span class="st">"Correlation matrix of different variables"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<caption>Correlation matrix of different variables</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 10%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 15%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">DEP_DELAY</th>
<th style="text-align: right;">ARR_DELAY</th>
<th style="text-align: right;">CRS_DEP_TIME</th>
<th style="text-align: right;">WHEELS_OFF</th>
<th style="text-align: right;">WHEELS_ON</th>
<th style="text-align: right;">DISTANCE</th>
<th style="text-align: right;">ACTUAL_ELAPSED_TIME</th>
<th style="text-align: right;">TAXI_OUT</th>
<th style="text-align: right;">TAXI_IN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">DEP_DELAY</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.8879422</td>
<td style="text-align: right;">0.1780300</td>
<td style="text-align: right;">0.2329716</td>
<td style="text-align: right;">0.0879676</td>
<td style="text-align: right;">0.0530508</td>
<td style="text-align: right;">0.0608624</td>
<td style="text-align: right;">0.0540390</td>
<td style="text-align: right;">-0.0049062</td>
</tr>
<tr class="even">
<td style="text-align: left;">ARR_DELAY</td>
<td style="text-align: right;">0.8879422</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.1449869</td>
<td style="text-align: right;">0.2149834</td>
<td style="text-align: right;">0.0900263</td>
<td style="text-align: right;">0.0343948</td>
<td style="text-align: right;">0.1903733</td>
<td style="text-align: right;">0.4001428</td>
<td style="text-align: right;">0.0866103</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CRS_DEP_TIME</td>
<td style="text-align: right;">0.1780300</td>
<td style="text-align: right;">0.1449869</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.9710676</td>
<td style="text-align: right;">0.8135008</td>
<td style="text-align: right;">-0.0707239</td>
<td style="text-align: right;">-0.0456351</td>
<td style="text-align: right;">0.1120957</td>
<td style="text-align: right;">-0.0622022</td>
</tr>
<tr class="even">
<td style="text-align: left;">WHEELS_OFF</td>
<td style="text-align: right;">0.2329716</td>
<td style="text-align: right;">0.2149834</td>
<td style="text-align: right;">0.9710676</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.8279598</td>
<td style="text-align: right;">-0.0603341</td>
<td style="text-align: right;">-0.0160242</td>
<td style="text-align: right;">0.1730932</td>
<td style="text-align: right;">-0.0561931</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WHEELS_ON</td>
<td style="text-align: right;">0.0879676</td>
<td style="text-align: right;">0.0900263</td>
<td style="text-align: right;">0.8135008</td>
<td style="text-align: right;">0.8279598</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.0066490</td>
<td style="text-align: right;">0.0596126</td>
<td style="text-align: right;">0.1755272</td>
<td style="text-align: right;">-0.0181294</td>
</tr>
<tr class="even">
<td style="text-align: left;">DISTANCE</td>
<td style="text-align: right;">0.0530508</td>
<td style="text-align: right;">0.0343948</td>
<td style="text-align: right;">-0.0707239</td>
<td style="text-align: right;">-0.0603341</td>
<td style="text-align: right;">0.0066490</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.9298512</td>
<td style="text-align: right;">-0.0095594</td>
<td style="text-align: right;">0.1186520</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ACTUAL_ELAPSED_TIME</td>
<td style="text-align: right;">0.0608624</td>
<td style="text-align: right;">0.1903733</td>
<td style="text-align: right;">-0.0456351</td>
<td style="text-align: right;">-0.0160242</td>
<td style="text-align: right;">0.0596126</td>
<td style="text-align: right;">0.9298512</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">0.2885034</td>
<td style="text-align: right;">0.2081655</td>
</tr>
<tr class="even">
<td style="text-align: left;">TAXI_OUT</td>
<td style="text-align: right;">0.0540390</td>
<td style="text-align: right;">0.4001428</td>
<td style="text-align: right;">0.1120957</td>
<td style="text-align: right;">0.1730932</td>
<td style="text-align: right;">0.1755272</td>
<td style="text-align: right;">-0.0095594</td>
<td style="text-align: right;">0.2885034</td>
<td style="text-align: right;">1.0000000</td>
<td style="text-align: right;">-0.0091804</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TAXI_IN</td>
<td style="text-align: right;">-0.0049062</td>
<td style="text-align: right;">0.0866103</td>
<td style="text-align: right;">-0.0622022</td>
<td style="text-align: right;">-0.0561931</td>
<td style="text-align: right;">-0.0181294</td>
<td style="text-align: right;">0.1186520</td>
<td style="text-align: right;">0.2081655</td>
<td style="text-align: right;">-0.0091804</td>
<td style="text-align: right;">1.0000000</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This correlation plot helps us understand the relationship and colinearity among the potential variables used in our models. Some variables are time based (for example: <code>CRS_DEP_TIM</code>, <code>WHEELS_OFF</code>) with small differences, making them nearly perfect correlated. Such variables shouldn’t be included in the model together as they make the coefficients unstable. Other than that interesting potential predictors can be assessed from this correlation matrix.</p>
</section>
</section>
<section id="linear-model" class="level1">
<h1>Linear Model</h1>
<p><strong>Aim: Investigating the factors contributing to delays in arrival.</strong></p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>p1 <span class="ot">&lt;-</span> planes <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> DEP_DELAY, <span class="at">y =</span> ARR_DELAY)) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb8-6"><a href="#cb8-6"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Influence of Depature Delay on Arrival Delay"</span>,</span>
<span id="cb8-7"><a href="#cb8-7"></a>       <span class="at">x =</span> <span class="st">"Departure Delay"</span>,</span>
<span id="cb8-8"><a href="#cb8-8"></a>       <span class="at">y =</span> <span class="st">"Arrival Delay"</span>) </span>
<span id="cb8-9"><a href="#cb8-9"></a></span>
<span id="cb8-10"><a href="#cb8-10"></a>p2 <span class="ot">&lt;-</span> planes <span class="sc">%&gt;%</span> </span>
<span id="cb8-11"><a href="#cb8-11"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TAXI_OUT, <span class="at">y =</span> ARR_DELAY)) <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb8-13"><a href="#cb8-13"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span></span>
<span id="cb8-14"><a href="#cb8-14"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb8-15"><a href="#cb8-15"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Influence of Taxi Out on Arrival Delay"</span>,</span>
<span id="cb8-16"><a href="#cb8-16"></a>       <span class="at">x =</span> <span class="st">"Taxi Out"</span>,</span>
<span id="cb8-17"><a href="#cb8-17"></a>       <span class="at">y =</span> <span class="st">"Arrival Delay"</span>) </span>
<span id="cb8-18"><a href="#cb8-18"></a></span>
<span id="cb8-19"><a href="#cb8-19"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
</div>
</div>
<p>From the plots above we see that both <code>DEP_DELAY</code> and <code>TAXI_OUT</code> are positively correlated with <code>ARR_DELAY</code>. It’s obvious that a delay in departure leads to a delay in arrival. Furthermore, the skeweness is again visiable in the plot. ## Modelling</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>lm.arrival <span class="ot">&lt;-</span> <span class="fu">lm</span>(ARR_DELAY <span class="sc">~</span> DEP_DELAY, <span class="at">data =</span> planes)</span>
<span id="cb9-2"><a href="#cb9-2"></a>lm.arrival<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">update</span>(lm.arrival, . <span class="sc">~</span> . <span class="sc">+</span> TAXI_OUT)</span>
<span id="cb9-3"><a href="#cb9-3"></a></span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="fu">anova</span>(lm.arrival, lm.arrival<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre style="color: blue"><code>Analysis of Variance Table

Model 1: ARR_DELAY ~ DEP_DELAY
Model 2: ARR_DELAY ~ DEP_DELAY + TAXI_OUT
  Res.Df      RSS Df Sum of Sq      F                Pr(&gt;F)    
1  96067 34554235                                              
2  96066 14239138  1  20315097 137058 &lt; 0.00000000000000022 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>We can see that the second model with the <code>TAXI_OUT</code> variable significantly improves the model fit.</p>
<p>Let’s see if we can improve the model further by adding the airlines as predictor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>lm.arrival<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">update</span>(lm.arrival<span class="fl">.2</span>, . <span class="sc">~</span> . <span class="sc">+</span> OP_CARRIER)</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="fu">drop1</span>(lm.arrival<span class="fl">.3</span>, <span class="at">test =</span><span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre style="color: blue"><code>Single term deletions

Model:
ARR_DELAY ~ DEP_DELAY + TAXI_OUT + OP_CARRIER
           Df Sum of Sq       RSS    AIC   F value                Pr(&gt;F)    
&lt;none&gt;                   13177731 472814                                    
DEP_DELAY   1 122296267 135473998 696677 891394.49 &lt; 0.00000000000000022 ***
TAXI_OUT    1  20788072  33965803 563773 151520.35 &lt; 0.00000000000000022 ***
OP_CARRIER 16   1061408  14239138 480224    483.52 &lt; 0.00000000000000022 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>We use <code>drop1</code> function, since <code>OP_CARRIER</code> has more than two levels. The addition of the <code>OP_CARRIER</code> variable significantly improves the model fit.</p>
<p>It could be more interesting to group the different <code>OP_CARRIER</code> into three categories of Cheap, Mid-tier and expensive airlines. For this we use chatGPT. Having three categories instead of 14 will help us to reduce the complexity of the model and make it easier to interpret and compare different levels of airlines. Especially, since some airlines how low flight counts. Of course these categories may not be complete true for each case. As ChatGPT mentions some airlines blur the categories as they could be considered cheap and or mid-tier and so on.</p>
<div class="cell">
<details class="code-fold">
<summary>Show ChatGPT classification</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>planes <span class="ot">&lt;-</span> planes <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">mutate</span>(<span class="at">OP_CARRIER_Tier =</span> <span class="fu">recode</span>(OP_CARRIER,</span>
<span id="cb13-3"><a href="#cb13-3"></a>    <span class="co"># Expensive</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>    <span class="st">"AA"</span> <span class="ot">=</span> <span class="st">"Expensive"</span>,</span>
<span id="cb13-5"><a href="#cb13-5"></a>    <span class="st">"DL"</span> <span class="ot">=</span> <span class="st">"Expensive"</span>,</span>
<span id="cb13-6"><a href="#cb13-6"></a>    <span class="st">"UA"</span> <span class="ot">=</span> <span class="st">"Expensive"</span>,</span>
<span id="cb13-7"><a href="#cb13-7"></a>    <span class="st">"CO"</span> <span class="ot">=</span> <span class="st">"Expensive"</span>,</span>
<span id="cb13-8"><a href="#cb13-8"></a></span>
<span id="cb13-9"><a href="#cb13-9"></a>    <span class="co"># Cheap</span></span>
<span id="cb13-10"><a href="#cb13-10"></a>    <span class="st">"B6"</span> <span class="ot">=</span> <span class="st">"Cheap"</span>,</span>
<span id="cb13-11"><a href="#cb13-11"></a>    <span class="st">"F9"</span> <span class="ot">=</span> <span class="st">"Cheap"</span>,</span>
<span id="cb13-12"><a href="#cb13-12"></a>    <span class="st">"FL"</span> <span class="ot">=</span> <span class="st">"Cheap"</span>,</span>
<span id="cb13-13"><a href="#cb13-13"></a>    <span class="st">"WN"</span> <span class="ot">=</span> <span class="st">"Cheap"</span>,</span>
<span id="cb13-14"><a href="#cb13-14"></a></span>
<span id="cb13-15"><a href="#cb13-15"></a>    <span class="co"># Mid-tier</span></span>
<span id="cb13-16"><a href="#cb13-16"></a>    <span class="st">"9E"</span> <span class="ot">=</span> <span class="st">"Mid-tier"</span>,</span>
<span id="cb13-17"><a href="#cb13-17"></a>    <span class="st">"EV"</span> <span class="ot">=</span> <span class="st">"Mid-tier"</span>,</span>
<span id="cb13-18"><a href="#cb13-18"></a>    <span class="st">"MQ"</span> <span class="ot">=</span> <span class="st">"Mid-tier"</span>,</span>
<span id="cb13-19"><a href="#cb13-19"></a>    <span class="st">"OH"</span> <span class="ot">=</span> <span class="st">"Mid-tier"</span>,</span>
<span id="cb13-20"><a href="#cb13-20"></a>    <span class="st">"OO"</span> <span class="ot">=</span> <span class="st">"Mid-tier"</span>,</span>
<span id="cb13-21"><a href="#cb13-21"></a>    <span class="st">"XE"</span> <span class="ot">=</span> <span class="st">"Mid-tier"</span>,</span>
<span id="cb13-22"><a href="#cb13-22"></a>    <span class="st">"YV"</span> <span class="ot">=</span> <span class="st">"Mid-tier"</span>,</span>
<span id="cb13-23"><a href="#cb13-23"></a>    <span class="st">"NW"</span> <span class="ot">=</span> <span class="st">"Mid-tier"</span>,</span>
<span id="cb13-24"><a href="#cb13-24"></a>    <span class="st">"US"</span> <span class="ot">=</span> <span class="st">"Mid-tier"</span>,</span>
<span id="cb13-25"><a href="#cb13-25"></a></span>
<span id="cb13-26"><a href="#cb13-26"></a>    <span class="at">.default =</span> <span class="cn">NA_character_</span></span>
<span id="cb13-27"><a href="#cb13-27"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb13-28"><a href="#cb13-28"></a>  <span class="fu">mutate</span>(<span class="at">OP_CARRIER_Tier =</span> <span class="fu">factor</span>(OP_CARRIER_Tier, </span>
<span id="cb13-29"><a href="#cb13-29"></a>                                  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Cheap"</span>, <span class="st">"Mid-tier"</span>, <span class="st">"Expensive"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>With including the <code>OP_CARRIER_Tier</code> variable we lose the individual information of each airline. Still, this is done because adding <code>OP_CARRIER_Tier</code> and <code>OP_CARRIER</code> would properly lead to rank-deficiency.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>lm.arrival<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">update</span>(lm.arrival<span class="fl">.3</span>, . <span class="sc">~</span> . <span class="sc">-</span>OP_CARRIER<span class="sc">+</span> OP_CARRIER_Tier)</span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="fu">drop1</span>(lm.arrival<span class="fl">.4</span>, <span class="at">test =</span> <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre style="color: blue"><code>Single term deletions

Model:
ARR_DELAY ~ DEP_DELAY + TAXI_OUT + OP_CARRIER_Tier
                Df Sum of Sq       RSS    AIC   F value                Pr(&gt;F)
&lt;none&gt;                        14133173 479511                                
DEP_DELAY        1 122177108 136310281 697241 830444.90 &lt; 0.00000000000000022
TAXI_OUT         1  20280397  34413571 565003 137847.04 &lt; 0.00000000000000022
OP_CARRIER_Tier  2    105965  14239138 480224    360.13 &lt; 0.00000000000000022
                   
&lt;none&gt;             
DEP_DELAY       ***
TAXI_OUT        ***
OP_CARRIER_Tier ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>After transformation <code>OP_CARRIER_Tier</code> significantly improves the model.</p>
<section id="post-hoc-tests" class="level2">
<h2 class="anchored" data-anchor-id="post-hoc-tests">Post-Hoc Tests</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>ph.test.THSD <span class="ot">&lt;-</span> <span class="fu">glht</span>(lm.arrival<span class="fl">.4</span>,</span>
<span id="cb16-2"><a href="#cb16-2"></a>    <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">OP_CARRIER_Tier =</span> <span class="st">"Tukey"</span>))</span>
<span id="cb16-3"><a href="#cb16-3"></a></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="fu">summary</span>(ph.test.THSD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre style="color: blue"><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: lm(formula = ARR_DELAY ~ DEP_DELAY + TAXI_OUT + OP_CARRIER_Tier, 
    data = planes)

Linear Hypotheses:
                          Estimate Std. Error t value      Pr(&gt;|t|)    
Mid-tier - Cheap == 0     -2.89168    0.13077 -22.112 &lt;0.0000000001 ***
Expensive - Cheap == 0    -3.54434    0.13219 -26.813 &lt;0.0000000001 ***
Expensive - Mid-tier == 0 -0.65267    0.08342  -7.824 &lt;0.0000000001 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
</div>
<p>We find strong evidence that all three pairwise differences are not equal to zero. Lets plot the differences:</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="fl">5.1</span>,<span class="fl">7.5</span>,<span class="fl">4.1</span>,<span class="fl">2.1</span>))</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="fu">plot</span>(ph.test.THSD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This plots shows us that the the difference between airline tiers is not zero in any case. Furthermore, the differences follow the possible intuition that cheaper flights are more likely to be delayed than mid-tier and expensive flights.</p>
</section>
<section id="interpretation-of-final-model" class="level2">
<h2 class="anchored" data-anchor-id="interpretation-of-final-model">Interpretation of final model</h2>
<section id="coefficients-of-model" class="level3">
<h3 class="anchored" data-anchor-id="coefficients-of-model">Coefficients of Model</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">summary</span>(lm.arrival<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre style="color: blue"><code>
Call:
lm(formula = ARR_DELAY ~ DEP_DELAY + TAXI_OUT + OP_CARRIER_Tier, 
    data = planes)

Residuals:
    Min      1Q  Median      3Q     Max 
-66.813  -7.610  -0.579   6.856 195.722 

Coefficients:
                           Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)              -26.858032   0.131610 -204.07 &lt;0.0000000000000002 ***
DEP_DELAY                  0.976010   0.001071  911.29 &lt;0.0000000000000002 ***
TAXI_OUT                   0.934567   0.002517  371.28 &lt;0.0000000000000002 ***
OP_CARRIER_TierMid-tier   -2.891678   0.130774  -22.11 &lt;0.0000000000000002 ***
OP_CARRIER_TierExpensive  -3.544343   0.132189  -26.81 &lt;0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.13 on 96064 degrees of freedom
  (4265 observations deleted due to missingness)
Multiple R-squared:  0.9135,    Adjusted R-squared:  0.9135 
F-statistic: 2.535e+05 on 4 and 96064 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
</div>
<ul>
<li><code>DEP_DEALY</code>: given all predictors in the model are kept constant, a 1 minute increase in <code>DEP_DELAY</code> leads to an increase in <code>ARR_DELAY</code> of 0.976 minutes on <em>average</em>.</li>
<li><code>TAXI_OUT</code>: given all predictors in the model are kept constant, a 1 minute increase in <code>TAXI_OUT</code> leads to an increase in <code>ARR_DELAY</code> of 0.935 minutes on <em>average</em>.</li>
<li><code>Intercept</code>: With <code>DEP_DELAY</code> and <code>TAXI_OUT</code> being 0, the average <code>ARR_DELAY</code> of <code>Cheap Airlines</code> is -26.858. Meaning that <strong>on average</strong> these flights arrival 27 min early. While a departure delay of zero is realistic and in range of our data, the taxi out time of zero is not realistic. With min of taxi out being 1. We could center <code>TAXI_OUT</code> so that zero represents the average taxi out time.</li>
<li><code>TierMid-tier</code>: <strong>on average</strong> Mid-tier airlines arrive 2.892 minutes earlier compared to cheap airlines.<br>
</li>
<li><code>TierExpensive</code>: <strong>on average</strong> Expensive airlines arrive 3.544 minutes earlier compared to cheap airlines.</li>
</ul>
</section>
<section id="lets-explore-our-model-variables-a-bit-more" class="level3">
<h3 class="anchored" data-anchor-id="lets-explore-our-model-variables-a-bit-more">Let’s explore our model variables a bit more</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>planes <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(ARR_DELAY, TAXI_OUT, DEP_DELAY),</span>
<span id="cb21-3"><a href="#cb21-3"></a>               <span class="at">names_to =</span> <span class="st">"Metric"</span>,</span>
<span id="cb21-4"><a href="#cb21-4"></a>               <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb21-5"><a href="#cb21-5"></a>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x =</span> Metric, <span class="at">y =</span> Value)) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6"></a>    <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Metric), <span class="at">outlier.alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> OP_CARRIER_Tier) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8"></a>    <span class="fu">labs</span>(</span>
<span id="cb21-9"><a href="#cb21-9"></a>      <span class="at">title =</span> <span class="st">"Boxplot of Metrics by Carrier Tier"</span>,</span>
<span id="cb21-10"><a href="#cb21-10"></a>      <span class="at">x =</span> <span class="st">"Metric"</span>,</span>
<span id="cb21-11"><a href="#cb21-11"></a>      <span class="at">y =</span> <span class="st">"Value"</span></span>
<span id="cb21-12"><a href="#cb21-12"></a>    ) <span class="sc">+</span></span>
<span id="cb21-13"><a href="#cb21-13"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb21-14"><a href="#cb21-14"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>These boxplots show the skewedness of the variables. Outliers may play a big role in the model and could drive differences in the averages. Since these outliers are not measurement error we will keep them in the data set. Still, it’s visiable that cheap airlines have more delayed flights (dep and arr)</p>
</section>
<section id="model-diagnostics" class="level3">
<h3 class="anchored" data-anchor-id="model-diagnostics">Model diagnostics</h3>
</section>
<section id="lets-look-at-density-plots" class="level3">
<h3 class="anchored" data-anchor-id="lets-look-at-density-plots">Let’s look at density plots</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">plot</span>(lm.arrival<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/unnamed-chunk-17-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/unnamed-chunk-17-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/unnamed-chunk-17-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>The <code>Q-Q plot</code> shows that the residuals are not normally distributed for higher values of <code>ARR_DELAY</code>. Higher arrival delays are underestimated by the model. Intuitively this could make sense, since extreme delay may not be linear anymore and considering the LGA flight curfew this could have an influence as well.</li>
<li>The overall fit of the model seem acceptable but as already mentioned with increased delay (extreme delays) the model fit decreases.</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>planes <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(ARR_DELAY, TAXI_OUT, DEP_DELAY),</span>
<span id="cb23-3"><a href="#cb23-3"></a>               <span class="at">names_to =</span> <span class="st">"Metric"</span>,</span>
<span id="cb23-4"><a href="#cb23-4"></a>               <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb23-5"><a href="#cb23-5"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">fill =</span> Metric, <span class="at">color =</span> Metric)) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> OP_CARRIER_Tier) <span class="sc">+</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">200</span>) <span class="sc">+</span> </span>
<span id="cb23-9"><a href="#cb23-9"></a>  <span class="fu">labs</span>(</span>
<span id="cb23-10"><a href="#cb23-10"></a>    <span class="at">title =</span> <span class="st">"Density of Metrics by Carrier Tier"</span>,</span>
<span id="cb23-11"><a href="#cb23-11"></a>    <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb23-12"><a href="#cb23-12"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb23-13"><a href="#cb23-13"></a>  ) <span class="sc">+</span></span>
<span id="cb23-14"><a href="#cb23-14"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="transformation" class="level3">
<h3 class="anchored" data-anchor-id="transformation">Transformation</h3>
<p>Since we have a lot of negative and zero values, we can’t use log transformation. Therefore we try a cubic root transformation.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>cbrt_transform <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb24-2"><a href="#cb24-2"></a>  <span class="fu">sign</span>(x) <span class="sc">*</span> <span class="fu">abs</span>(x)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>)</span>
<span id="cb24-3"><a href="#cb24-3"></a>}</span>
<span id="cb24-4"><a href="#cb24-4"></a></span>
<span id="cb24-5"><a href="#cb24-5"></a>planes <span class="sc">%&gt;%</span></span>
<span id="cb24-6"><a href="#cb24-6"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-7"><a href="#cb24-7"></a>    <span class="at">cbrt_arr_delay =</span> <span class="fu">cbrt_transform</span>(ARR_DELAY),</span>
<span id="cb24-8"><a href="#cb24-8"></a>    <span class="at">cbrt_dep_delay =</span> <span class="fu">cbrt_transform</span>(DEP_DELAY),</span>
<span id="cb24-9"><a href="#cb24-9"></a>    <span class="at">cbrt_taxi_out  =</span> <span class="fu">cbrt_transform</span>(TAXI_OUT)</span>
<span id="cb24-10"><a href="#cb24-10"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb24-11"><a href="#cb24-11"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(cbrt_arr_delay, cbrt_taxi_out, cbrt_dep_delay),</span>
<span id="cb24-12"><a href="#cb24-12"></a>               <span class="at">names_to =</span> <span class="st">"Metric"</span>,</span>
<span id="cb24-13"><a href="#cb24-13"></a>               <span class="at">values_to =</span> <span class="st">"Value"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-14"><a href="#cb24-14"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Value, <span class="at">fill =</span> Metric, <span class="at">color =</span> Metric)) <span class="sc">+</span></span>
<span id="cb24-15"><a href="#cb24-15"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb24-16"><a href="#cb24-16"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> OP_CARRIER_Tier) <span class="sc">+</span></span>
<span id="cb24-17"><a href="#cb24-17"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-18"><a href="#cb24-18"></a>    <span class="at">title =</span> <span class="st">"Density of Metrics by Carrier Tier"</span>,</span>
<span id="cb24-19"><a href="#cb24-19"></a>    <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb24-20"><a href="#cb24-20"></a>    <span class="at">y =</span> <span class="st">"Density"</span></span>
<span id="cb24-21"><a href="#cb24-21"></a>  ) <span class="sc">+</span></span>
<span id="cb24-22"><a href="#cb24-22"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The cubic root transformation produces a bimodal distribution for the <code>ARR_DELAY</code> and <code>DEP_DELAY</code> variables. Although this reveals an interesting pattern in the data, that most planes are on time (or more specific early) but the distribution shows slight delays to be somewhat common as well. Given the bimodality a normal regression modelling the average may not be better than using untransformed data. Interpretation of the model coefficents would become quit difficult after this transformation.</p>
</section>
<section id="z-normalization" class="level3">
<h3 class="anchored" data-anchor-id="z-normalization">z-normalization</h3>
<p>To help with interpretation and entangle the relative effects of <code>TAXI_OUT</code> and <code>DEP_DELAY</code> on <code>ARR_DELAY</code> we can z-normalize the variables. The model fit will not change (as shown later). But it will help with interpretation of the intercept since a z-value of zero represents the average of the variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>planes <span class="ot">&lt;-</span> planes <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-3"><a href="#cb25-3"></a>    <span class="at">z_dep_delay =</span> <span class="fu">scale</span>(DEP_DELAY),</span>
<span id="cb25-4"><a href="#cb25-4"></a>    <span class="at">z_taxi_out  =</span> <span class="fu">scale</span>(TAXI_OUT)</span>
<span id="cb25-5"><a href="#cb25-5"></a>  )</span>
<span id="cb25-6"><a href="#cb25-6"></a></span>
<span id="cb25-7"><a href="#cb25-7"></a>lm.arrival<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(ARR_DELAY <span class="sc">~</span> z_dep_delay <span class="sc">+</span> z_taxi_out <span class="sc">+</span> OP_CARRIER_Tier, <span class="at">data =</span> planes)</span>
<span id="cb25-8"><a href="#cb25-8"></a><span class="fu">summary</span>(lm.arrival<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre style="color: blue"><code>
Call:
lm(formula = ARR_DELAY ~ z_dep_delay + z_taxi_out + OP_CARRIER_Tier, 
    data = planes)

Residuals:
    Min      1Q  Median      3Q     Max 
-66.813  -7.610  -0.579   6.856 195.722 

Coefficients:
                         Estimate Std. Error t value            Pr(&gt;|t|)    
(Intercept)               6.30437    0.11744   53.68 &lt;0.0000000000000002 ***
z_dep_delay              35.85451    0.03934  911.29 &lt;0.0000000000000002 ***
z_taxi_out               14.65554    0.03947  371.28 &lt;0.0000000000000002 ***
OP_CARRIER_TierMid-tier  -2.89168    0.13077  -22.11 &lt;0.0000000000000002 ***
OP_CARRIER_TierExpensive -3.54434    0.13219  -26.81 &lt;0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 12.13 on 96064 degrees of freedom
  (4265 observations deleted due to missingness)
Multiple R-squared:  0.9135,    Adjusted R-squared:  0.9135 
F-statistic: 2.535e+05 on 4 and 96064 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="co">#plot(lm.arrival.5)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><code>Intercept</code>: Cheap airlines with average depature delay and average taxi out arrive <strong>on average</strong> 6.30 minutes late.</li>
<li><code>TierMid-tier</code>: Mid-tier airlines with average depature delay and average taxi out arrive <strong>on average</strong> 3.413 minutes late.</li>
<li><code>TierExpensive</code>: Expensive airlines with average depature delay and average taxi out arrive <strong>on average</strong> 2.76 minutes late.</li>
<li>This again shows that using the average for modelling may give us a biased picture.</li>
<li>We see that <code>z_dep_delay</code> has a higher relative effect on arrival delay than <code>z_taxi_out</code>. This was not so clear in the model without transformation and is likely because depature delay has a larger range compared to taxi out time.</li>
</ul>
</section>
</section>
</section>
<section id="glm-poisson" class="level1">
<h1>GLM Poisson</h1>
<p>Airports are hectic and resources can be limited if not managed properly. Coordination is key for good resource allocation. For example to clean the interior of a plane there is only a certain time window available. Since every minute counts we aim to predict the <code>Taxi in</code> time of a plane. In the case of plane cleaning, this knowledge would help with coordination and resource allocation.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>p1<span class="ot">&lt;-</span> planes <span class="sc">%&gt;%</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ARR_DELAY, <span class="at">y =</span> TAXI_IN)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>,</span>
<span id="cb28-5"><a href="#cb28-5"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"quasipoisson"</span>),</span>
<span id="cb28-6"><a href="#cb28-6"></a>              <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb28-7"><a href="#cb28-7"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb28-8"><a href="#cb28-8"></a>              <span class="at">color =</span> <span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb28-9"><a href="#cb28-9"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb28-10"><a href="#cb28-10"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">""</span>,</span>
<span id="cb28-11"><a href="#cb28-11"></a>       <span class="at">x =</span> <span class="st">"ARR_DELAY"</span>,</span>
<span id="cb28-12"><a href="#cb28-12"></a>       <span class="at">y =</span> <span class="st">"Taxi In Time"</span>) </span>
<span id="cb28-13"><a href="#cb28-13"></a></span>
<span id="cb28-14"><a href="#cb28-14"></a>p2<span class="ot">&lt;-</span> planes <span class="sc">%&gt;%</span></span>
<span id="cb28-15"><a href="#cb28-15"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> DEP_DELAY, <span class="at">y =</span> TAXI_IN)) <span class="sc">+</span></span>
<span id="cb28-16"><a href="#cb28-16"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb28-17"><a href="#cb28-17"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>,</span>
<span id="cb28-18"><a href="#cb28-18"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"quasipoisson"</span>),</span>
<span id="cb28-19"><a href="#cb28-19"></a>              <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb28-20"><a href="#cb28-20"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb28-21"><a href="#cb28-21"></a>              <span class="at">color =</span> <span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb28-22"><a href="#cb28-22"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb28-23"><a href="#cb28-23"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">""</span>,</span>
<span id="cb28-24"><a href="#cb28-24"></a>       <span class="at">x =</span> <span class="st">"DEP_DELAY"</span>,</span>
<span id="cb28-25"><a href="#cb28-25"></a>       <span class="at">y =</span> <span class="st">"Taxi In Time"</span>)</span>
<span id="cb28-26"><a href="#cb28-26"></a></span>
<span id="cb28-27"><a href="#cb28-27"></a>p3 <span class="ot">&lt;-</span> planes <span class="sc">%&gt;%</span></span>
<span id="cb28-28"><a href="#cb28-28"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> TAXI_OUT, <span class="at">y =</span> TAXI_IN)) <span class="sc">+</span></span>
<span id="cb28-29"><a href="#cb28-29"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb28-30"><a href="#cb28-30"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"glm"</span>,</span>
<span id="cb28-31"><a href="#cb28-31"></a>              <span class="at">method.args =</span> <span class="fu">list</span>(<span class="at">family =</span> <span class="st">"quasipoisson"</span>),</span>
<span id="cb28-32"><a href="#cb28-32"></a>              <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb28-33"><a href="#cb28-33"></a>              <span class="at">se =</span> <span class="cn">FALSE</span>,</span>
<span id="cb28-34"><a href="#cb28-34"></a>              <span class="at">color =</span> <span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb28-35"><a href="#cb28-35"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb28-36"><a href="#cb28-36"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">""</span>,</span>
<span id="cb28-37"><a href="#cb28-37"></a>       <span class="at">x =</span> <span class="st">"TAXI_OUT"</span>,</span>
<span id="cb28-38"><a href="#cb28-38"></a>       <span class="at">y =</span> <span class="st">"Taxi In Time"</span>)</span>
<span id="cb28-39"><a href="#cb28-39"></a></span>
<span id="cb28-40"><a href="#cb28-40"></a></span>
<span id="cb28-41"><a href="#cb28-41"></a>p1 <span class="sc">+</span> p2 <span class="sc">+</span> p3 <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">3</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>We see that <code>ARR_DELAY</code> seems to have an influence on <code>TAXI_IN</code> time. The more delayed a plane arrives the longer it takes to taxi in.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>glm.poisson <span class="ot">&lt;-</span> <span class="fu">glm</span>(TAXI_IN <span class="sc">~</span> ARR_DELAY<span class="sc">*</span>OP_CARRIER_Tier,</span>
<span id="cb29-2"><a href="#cb29-2"></a>  <span class="at">family =</span> <span class="st">"quasipoisson"</span>,</span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="at">data =</span> planes)</span>
<span id="cb29-4"><a href="#cb29-4"></a></span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="fu">print</span>(<span class="fu">summary</span>(glm.poisson)<span class="sc">$</span>coefficients <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre style="color: blue"><code>                                     Estimate Std. Error    t value  Pr(&gt;|t|)
(Intercept)                         1.9777051  0.0063070 313.572945 0.0000000
ARR_DELAY                           0.0006679  0.0001187   5.627072 0.0000000
OP_CARRIER_TierMid-tier            -0.1370338  0.0070907 -19.325908 0.0000000
OP_CARRIER_TierExpensive            0.1691667  0.0069746  24.254637 0.0000000
ARR_DELAY:OP_CARRIER_TierMid-tier   0.0004641  0.0001388   3.342644 0.0008302
ARR_DELAY:OP_CARRIER_TierExpensive  0.0009579  0.0001345   7.121269 0.0000000</code></pre>
</div>
</div>
</section>
<section id="glm-binomial" class="level1">
<h1>GLM Binomial</h1>
<p><a href="Regulation%20(EC)%20261/2004">https://www.bazl.admin.ch/bazl/en/home/passagiere/air-passenger-rights/nichtbefoerderung–annullierung-und-grosse-verspaetungen/grosse-verspaetungen.html</a> states a European court of justice ruling that passengers are entitled to compensation if their flight is delayed by more than 3 hours. <em>Due to the lack of a legal basis, the FOCA is unable to fine an airline for failure to pay compensation in the event of a delay</em></p>
<p><strong>Aim: What airline has the most flights with more than 180 minutes delay and how are differences in proportions explained</strong></p>
<section id="percentage-of-flights-with-more-than-180-minutes-delay" class="level2">
<h2 class="anchored" data-anchor-id="percentage-of-flights-with-more-than-180-minutes-delay">Percentage of flights with more than 180 minutes delay</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>planes <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>  <span class="fu">mutate</span>(<span class="at">index_late_dep =</span> <span class="fu">ifelse</span>(DEP_DELAY <span class="sc">&gt;</span> <span class="dv">180</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>  <span class="fu">group_by</span>(OP_CARRIER) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4"></a>  <span class="fu">summarise</span>(</span>
<span id="cb31-5"><a href="#cb31-5"></a>    <span class="at">Total_flights =</span> <span class="fu">n</span>(),</span>
<span id="cb31-6"><a href="#cb31-6"></a>    <span class="at">Total_delayed_dep =</span> <span class="fu">sum</span>(index_late_dep <span class="sc">==</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-7"><a href="#cb31-7"></a>    <span class="at">percentage_delayed_dep =</span> Total_delayed_dep <span class="sc">/</span> Total_flights <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb31-8"><a href="#cb31-8"></a>    <span class="at">Mean_dep_delay =</span> <span class="fu">mean</span>(DEP_DELAY, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb31-9"><a href="#cb31-9"></a>    <span class="at">Airline_tier =</span> <span class="fu">unique</span>(OP_CARRIER_Tier)</span>
<span id="cb31-10"><a href="#cb31-10"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb31-11"><a href="#cb31-11"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(percentage_delayed_dep)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-12"><a href="#cb31-12"></a>  <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  OP_CARRIER Total_flights Total_delayed_dep percentage_delayed_dep
  &lt;fct&gt;              &lt;int&gt;             &lt;int&gt;                  &lt;dbl&gt;
1 OO                    27                 1                   3.70
2 WN                  1422                40                   2.81
3 FL                  5954               107                   1.80
4 XE                   890                14                   1.57
5 CO                  3666                53                   1.45
6 YV                  1041                15                   1.44
# ℹ 2 more variables: Mean_dep_delay &lt;dbl&gt;, Airline_tier &lt;fct&gt;</code></pre>
</div>
</div>
<p>We see very low percentages of flights that depart later than 180 minutes.</p>
<p>We will use aggregated data on a airline level. We will end up with 17 data points which should be kept in mind during interpretation. Furthermore, since the percentage of flights arrived 3 hours later is very low and similar. Therefore we will decrease the threshold to 30 minutes which increases the differences between airlines.</p>
<section id="aggregated-data" class="level3">
<h3 class="anchored" data-anchor-id="aggregated-data">Aggregated Data</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>planes_agg <span class="ot">&lt;-</span> planes <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="fu">mutate</span>(<span class="at">index_late_dep =</span> <span class="fu">ifelse</span>(DEP_DELAY <span class="sc">&gt;</span> <span class="dv">30</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3"></a>  <span class="fu">group_by</span>(OP_CARRIER) <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>  <span class="fu">summarise</span>(</span>
<span id="cb33-5"><a href="#cb33-5"></a>    <span class="at">OP_CARRIER =</span> <span class="fu">first</span>(OP_CARRIER),</span>
<span id="cb33-6"><a href="#cb33-6"></a>    <span class="at">Total_flights =</span> <span class="fu">n</span>(),</span>
<span id="cb33-7"><a href="#cb33-7"></a>    <span class="at">Total_delayed_dep_over30 =</span> <span class="fu">sum</span>(index_late_dep <span class="sc">==</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-8"><a href="#cb33-8"></a>    <span class="at">Total_delayed_dep_under30 =</span> <span class="fu">sum</span>(index_late_dep<span class="sc">==</span> <span class="dv">0</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-9"><a href="#cb33-9"></a>    <span class="at">Mean_dep_delay =</span> <span class="fu">mean</span>(DEP_DELAY, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-10"><a href="#cb33-10"></a>    <span class="at">Mean_arr_delay =</span> <span class="fu">mean</span>(ARR_DELAY, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-11"><a href="#cb33-11"></a>    <span class="at">Mean_distance =</span> <span class="fu">mean</span>(DISTANCE, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb33-12"><a href="#cb33-12"></a>    <span class="at">Carrier_tier =</span> <span class="fu">unique</span>(OP_CARRIER_Tier),</span>
<span id="cb33-13"><a href="#cb33-13"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span></span>
<span id="cb33-14"><a href="#cb33-14"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>glm.late <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">cbind</span>(Total_delayed_dep_over30, Total_delayed_dep_under30) <span class="sc">~</span> </span>
<span id="cb34-2"><a href="#cb34-2"></a>                 Carrier_tier <span class="sc">+</span> Mean_dep_delay <span class="sc">+</span> Mean_distance <span class="sc">+</span> Total_flights,</span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="at">family =</span> <span class="st">"quasibinomial"</span>,</span>
<span id="cb34-4"><a href="#cb34-4"></a>  <span class="at">data =</span> <span class="fu">na.omit</span>(planes_agg))</span>
<span id="cb34-5"><a href="#cb34-5"></a></span>
<span id="cb34-6"><a href="#cb34-6"></a><span class="fu">print</span>(<span class="fu">summary</span>(glm.late)<span class="sc">$</span>coefficients)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre style="color: blue"><code>                             Estimate     Std. Error     t value
(Intercept)           -2.884661712402 0.185236007853 -15.5728994
Carrier_tierMid-tier   0.039102667464 0.107499989922   0.3637458
Carrier_tierExpensive -0.077424057928 0.125873286598  -0.6150952
Mean_dep_delay         0.075350839553 0.008433785936   8.9344027
Mean_distance          0.000194295108 0.000156893908   1.2383853
Total_flights          0.000004283091 0.000008836257   0.4847178
                               Pr(&gt;|t|)
(Intercept)           0.000000007676316
Carrier_tierMid-tier  0.722942397711622
Carrier_tierExpensive 0.551004409194349
Mean_dep_delay        0.000002251561208
Mean_distance         0.241350687512443
Total_flights         0.637384586921758</code></pre>
</div>
</div>
<p>Adding overdispersion to the model improves the fit. Eliminates most significant effects. There was no evidence found that airlines tiers have an influence on the proportion of flights with more than 30 minutes delay. The intercept (i.e.&nbsp;cheap tier airlines) are not interpreted, since total flights of zero is not realistic. We see that the mean departure delay has a significant effect on the proportion of flights with more than 30 minutes delay. So, an airline with a higher average departure delay has a higher proportion of flights with more than 30 minutes delay.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="fu">exp</span>(<span class="fu">coef</span>(glm.late)[<span class="st">"Mean_dep_delay"</span>]<span class="sc">*</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="at">digits=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Mean_dep_delay 
          2.12 </code></pre>
</div>
</div>
<p>More specifically, the odds of airline flights being delayed by more than 30 minutes increase by 2.12 times for each 10 minutes increase in average departure delay and no evidence is found that airline tiers can explain differences in proportions of flights with more than 30 minutes delay. While interpretation one needs to keep in mind that we have few observation on the aggregated level and furthermore, both <code>Y</code> and <code>Mean_dep_delay</code> are calculated from the same data: <code>DEP_DELAY</code>.</p>
</section>
</section>
</section>
<section id="neural-network" class="level1">
<h1>Neural Network</h1>
</section>
<section id="support-vector-machine" class="level1">
<h1>Support Vector Machine</h1>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>