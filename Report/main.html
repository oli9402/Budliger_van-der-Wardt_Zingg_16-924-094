<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lenny Budlinger">
<meta name="author" content="Thomas van der Wardt">
<meta name="author" content="Oliver Zingg">

<title>Project Title</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="main_files/libs/clipboard/clipboard.min.js"></script>
<script src="main_files/libs/quarto-html/quarto.js"></script>
<script src="main_files/libs/quarto-html/popper.min.js"></script>
<script src="main_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="main_files/libs/quarto-html/anchor.min.js"></script>
<link href="main_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="main_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="main_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="main_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="main_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#packages" id="toc-packages" class="nav-link active" data-scroll-target="#packages">Packages</a>
  <ul class="collapse">
  <li><a href="#load" id="toc-load" class="nav-link" data-scroll-target="#load">Load</a></li>
  <li><a href="#description-of-the-lga-data-set" id="toc-description-of-the-lga-data-set" class="nav-link" data-scroll-target="#description-of-the-lga-data-set">Description of the LGA Data set</a>
  <ul class="collapse">
  <li><a href="#flights-by-carrier" id="toc-flights-by-carrier" class="nav-link" data-scroll-target="#flights-by-carrier">Flights by Carrier</a></li>
  <li><a href="#total-percentage-of-delayed-arrivals" id="toc-total-percentage-of-delayed-arrivals" class="nav-link" data-scroll-target="#total-percentage-of-delayed-arrivals">Total percentage of delayed arrivals</a></li>
  <li><a href="#total-flights-by-carrier-and-percentage-delayed-arrivals" id="toc-total-flights-by-carrier-and-percentage-delayed-arrivals" class="nav-link" data-scroll-target="#total-flights-by-carrier-and-percentage-delayed-arrivals">Total flights by Carrier and percentage delayed arrivals</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#key-take-aways" id="toc-key-take-aways" class="nav-link" data-scroll-target="#key-take-aways">Key take aways</a>
  <ul class="collapse">
  <li><a href="#problems-with-modelling-and-data" id="toc-problems-with-modelling-and-data" class="nav-link" data-scroll-target="#problems-with-modelling-and-data">Problems with modelling and data</a></li>
  <li><a href="#interpretations-of-results" id="toc-interpretations-of-results" class="nav-link" data-scroll-target="#interpretations-of-results">Interpretations of results</a></li>
  </ul></li>
  <li><a href="#modelling" id="toc-modelling" class="nav-link" data-scroll-target="#modelling">Modelling</a>
  <ul class="collapse">
  <li><a href="#linear-model" id="toc-linear-model" class="nav-link" data-scroll-target="#linear-model">Linear Model</a></li>
  <li><a href="#glm-poisson" id="toc-glm-poisson" class="nav-link" data-scroll-target="#glm-poisson">GLM Poisson</a></li>
  <li><a href="#glm-binomial" id="toc-glm-binomial" class="nav-link" data-scroll-target="#glm-binomial">GLM Binomial</a></li>
  <li><a href="#gam" id="toc-gam" class="nav-link" data-scroll-target="#gam">GAM</a></li>
  <li><a href="#neural-network" id="toc-neural-network" class="nav-link" data-scroll-target="#neural-network">Neural Network</a></li>
  <li><a href="#support-vector-machine" id="toc-support-vector-machine" class="nav-link" data-scroll-target="#support-vector-machine">Support Vector Machine</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Project Title</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Lenny Budlinger </p>
             <p>Thomas van der Wardt </p>
             <p>Oliver Zingg </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="packages" class="level1">
<h1>Packages</h1>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Load packages -----------------------------</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(tidyverse) <span class="co"># ggplot for plotting, dplyr for data manipulation</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(lubridate) <span class="co"># package for handling time variable</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(hms) <span class="co"># handling time</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(gt) <span class="co"># Print tables</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(forcats) <span class="co"># Reorder factor levels</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">library</span>(janitor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="load" class="level2">
<h2 class="anchored" data-anchor-id="load">Load</h2>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Load data ---------------------------</span></span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co"># get working directory if csv not loading or use absolute path</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># getwd() </span></span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="fu">load</span>(<span class="st">"./../Data/LGA_preprocessed.rda"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="description-of-the-lga-data-set" class="level2">
<h2 class="anchored" data-anchor-id="description-of-the-lga-data-set">Description of the LGA Data set</h2>
<section id="flights-by-carrier" class="level3">
<h3 class="anchored" data-anchor-id="flights-by-carrier">Flights by Carrier</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>planes <span class="sc">%&gt;%</span> </span>
<span id="cb3-2"><a href="#cb3-2"></a>  <span class="fu">tabyl</span>(OP_CARRIER) <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>  <span class="fu">adorn_pct_formatting</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">OP_CARRIER</th>
<th style="text-align: right;">n</th>
<th style="text-align: left;">percent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">AA</td>
<td style="text-align: right;">16968</td>
<td style="text-align: left;">16.9%</td>
</tr>
<tr class="even">
<td style="text-align: left;">DL</td>
<td style="text-align: right;">14455</td>
<td style="text-align: left;">14.4%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">US</td>
<td style="text-align: right;">12774</td>
<td style="text-align: left;">12.7%</td>
</tr>
<tr class="even">
<td style="text-align: left;">MQ</td>
<td style="text-align: right;">11298</td>
<td style="text-align: left;">11.3%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OH</td>
<td style="text-align: right;">11162</td>
<td style="text-align: left;">11.1%</td>
</tr>
<tr class="even">
<td style="text-align: left;">NW</td>
<td style="text-align: right;">8754</td>
<td style="text-align: left;">8.7%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">UA</td>
<td style="text-align: right;">6578</td>
<td style="text-align: left;">6.6%</td>
</tr>
<tr class="even">
<td style="text-align: left;">FL</td>
<td style="text-align: right;">5954</td>
<td style="text-align: left;">5.9%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CO</td>
<td style="text-align: right;">3666</td>
<td style="text-align: left;">3.7%</td>
</tr>
<tr class="even">
<td style="text-align: left;">B6</td>
<td style="text-align: right;">2899</td>
<td style="text-align: left;">2.9%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9E</td>
<td style="text-align: right;">1547</td>
<td style="text-align: left;">1.5%</td>
</tr>
<tr class="even">
<td style="text-align: left;">WN</td>
<td style="text-align: right;">1422</td>
<td style="text-align: left;">1.4%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">YV</td>
<td style="text-align: right;">1041</td>
<td style="text-align: left;">1.0%</td>
</tr>
<tr class="even">
<td style="text-align: left;">XE</td>
<td style="text-align: right;">890</td>
<td style="text-align: left;">0.9%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">F9</td>
<td style="text-align: right;">727</td>
<td style="text-align: left;">0.7%</td>
</tr>
<tr class="even">
<td style="text-align: left;">EV</td>
<td style="text-align: right;">172</td>
<td style="text-align: left;">0.2%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OO</td>
<td style="text-align: right;">27</td>
<td style="text-align: left;">0.0%</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="total-percentage-of-delayed-arrivals" class="level3">
<h3 class="anchored" data-anchor-id="total-percentage-of-delayed-arrivals">Total percentage of delayed arrivals</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Percentage of late arrivals</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>planes <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3"></a>  <span class="fu">mutate</span>(<span class="at">index_late =</span> <span class="fu">ifelse</span>(ARR_DELAY <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>  <span class="fu">count</span>(index_late) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  index_late     n percentage
1          0 60757  60.554747
2          1 35312  35.194451
3         NA  4265   4.250802</code></pre>
</div>
</div>
</section>
<section id="total-flights-by-carrier-and-percentage-delayed-arrivals" class="level3">
<h3 class="anchored" data-anchor-id="total-flights-by-carrier-and-percentage-delayed-arrivals">Total flights by Carrier and percentage delayed arrivals</h3>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>planes <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="#cb6-2"></a>  <span class="fu">mutate</span>(<span class="at">index_late =</span> <span class="fu">ifelse</span>(ARR_DELAY <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>  <span class="fu">group_by</span>(OP_CARRIER, index_late) <span class="sc">%&gt;%</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="fu">group_by</span>(OP_CARRIER) <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="fu">mutate</span>(<span class="at">percentage_late =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="fu">mutate</span>(<span class="at">percentage_late =</span> <span class="fu">round</span>(percentage_late, <span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="fu">filter</span>(index_late <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>  <span class="fu">select</span>(<span class="sc">-</span>index_late) <span class="sc">%&gt;%</span> </span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">OP_CARRIER</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">percentage_late</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">AA</td>
<td style="text-align: right;">5699</td>
<td style="text-align: right;">33.59</td>
</tr>
<tr class="even">
<td style="text-align: left;">OH</td>
<td style="text-align: right;">5090</td>
<td style="text-align: right;">45.60</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DL</td>
<td style="text-align: right;">4781</td>
<td style="text-align: right;">33.08</td>
</tr>
<tr class="even">
<td style="text-align: left;">MQ</td>
<td style="text-align: right;">3822</td>
<td style="text-align: right;">33.83</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NW</td>
<td style="text-align: right;">3593</td>
<td style="text-align: right;">41.04</td>
</tr>
<tr class="even">
<td style="text-align: left;">US</td>
<td style="text-align: right;">3416</td>
<td style="text-align: right;">26.74</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FL</td>
<td style="text-align: right;">2373</td>
<td style="text-align: right;">39.86</td>
</tr>
<tr class="even">
<td style="text-align: left;">UA</td>
<td style="text-align: right;">1965</td>
<td style="text-align: right;">29.87</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CO</td>
<td style="text-align: right;">1390</td>
<td style="text-align: right;">37.92</td>
</tr>
<tr class="even">
<td style="text-align: left;">B6</td>
<td style="text-align: right;">1237</td>
<td style="text-align: right;">42.67</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9E</td>
<td style="text-align: right;">502</td>
<td style="text-align: right;">32.45</td>
</tr>
<tr class="even">
<td style="text-align: left;">WN</td>
<td style="text-align: right;">421</td>
<td style="text-align: right;">29.61</td>
</tr>
<tr class="odd">
<td style="text-align: left;">F9</td>
<td style="text-align: right;">346</td>
<td style="text-align: right;">47.59</td>
</tr>
<tr class="even">
<td style="text-align: left;">YV</td>
<td style="text-align: right;">335</td>
<td style="text-align: right;">32.18</td>
</tr>
<tr class="odd">
<td style="text-align: left;">XE</td>
<td style="text-align: right;">282</td>
<td style="text-align: right;">31.69</td>
</tr>
<tr class="even">
<td style="text-align: left;">EV</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">27.33</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OO</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">48.15</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>planes <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">filter</span>(OP_CARRIER <span class="sc">==</span> <span class="st">"WN"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Season, <span class="at">y =</span> DEP_DELAY)) <span class="sc">+</span> </span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="fu">labs</span>(</span>
<span id="cb7-6"><a href="#cb7-6"></a>    <span class="at">title =</span> <span class="st">"Boxplots of Departure Delay for carrier WN"</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>  )<span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb7-9"><a href="#cb7-9"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>)</span>
<span id="cb7-10"><a href="#cb7-10"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>planes <span class="sc">%&gt;%</span> </span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">group_by</span>(Season) <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">count</span>(CANCELLED)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 3
# Groups:   Season [4]
  Season CANCELLED     n
  &lt;fct&gt;      &lt;int&gt; &lt;int&gt;
1 Fall           0 23215
2 Fall           1   358
3 Spring         0 24658
4 Spring         1  1104
5 Summer         0 25180
6 Summer         1  1195
7 Winter         0 23285
8 Winter         1  1339</code></pre>
</div>
</div>
<p>It is interesting that the number of flights are similar across seasons. This may be explain by the fact that this dataset only consists of domestic outgoing flights from LGA. Tourism from different continents is not represented in not dataset.</p>
<p>Is delay influenced by departure time? Let’s plot planned departure time (<code>CRS_DEP_TIME</code>) vs.&nbsp;Delay time (<code>DEP_DELAY</code>) by seasons:</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>planes <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(CRS_DEP_TIME,DEP_DELAY,  <span class="at">color =</span> Season)) <span class="sc">+</span> </span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1250</span>)) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2400</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This plot is quit interesting and reveals a certain pattern that needs to be considered in our analysis. Firstly, Wikipedia states LGA has a curfew between the hours of 12am and 6am during the warm months of the year. Looking at x axis this curfew is visible. From this plot it is unclear whether planned departure time has an influence on delay. Though it seems as if that there are more delays during the summer.</p>
<p>Let’s look at weekday. Outlines dominate the visuals but we can’t use log_10 scale on y axis because we have a lot of on time planes (y = 0) or leaving early planes (y = negative). 0 is -inf and negative numbers are undefined with log10. So we decrease the limits show in the plot</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>planes <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2"></a>  <span class="fu">mutate</span>(<span class="at">Weekday =</span> <span class="fu">fct_relevel</span>(Weekday, <span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>, <span class="st">"Saturday"</span>, <span class="st">"Sunday"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> DEP_DELAY)) <span class="sc">+</span> </span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">"red"</span>,<span class="at">outlier.shape =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb11-5"><a href="#cb11-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept  =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"red"</span>,<span class="at">linetype=</span><span class="st">'dotted'</span>) <span class="sc">+</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Weekday)<span class="sc">+</span> </span>
<span id="cb11-7"><a href="#cb11-7"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>planes <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2"></a>  <span class="fu">mutate</span>(<span class="at">Weekday =</span> <span class="fu">fct_relevel</span>(Weekday, <span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>, <span class="st">"Saturday"</span>, <span class="st">"Sunday"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Season, DEP_DELAY)) <span class="sc">+</span> </span>
<span id="cb12-4"><a href="#cb12-4"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb12-5"><a href="#cb12-5"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept  =</span> <span class="dv">0</span>, <span class="at">linetype=</span><span class="st">'dotted'</span>,<span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Weekday) <span class="sc">+</span> </span>
<span id="cb12-7"><a href="#cb12-7"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It is interesting that 75% of planes leave early. It’s would be interesting to explore <code>WHEELS_OFF</code> variable which is the time point the plane leaves the ground.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>planes <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2"></a>  <span class="fu">select</span>(DEP_DELAY,ARR_DELAY,CRS_DEP_TIME,WHEELS_OFF,WHEELS_ON, DISTANCE,ACTUAL_ELAPSED_TIME,AIR_TIME) <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">"complete.obs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                     DEP_DELAY  ARR_DELAY CRS_DEP_TIME  WHEELS_OFF   WHEELS_ON
DEP_DELAY           1.00000000 0.88794222   0.17802997  0.23297159 0.087967565
ARR_DELAY           0.88794222 1.00000000   0.14498692  0.21498341 0.090026284
CRS_DEP_TIME        0.17802997 0.14498692   1.00000000  0.97106762 0.813500830
WHEELS_OFF          0.23297159 0.21498341   0.97106762  1.00000000 0.827959772
WHEELS_ON           0.08796756 0.09002628   0.81350083  0.82795977 1.000000000
DISTANCE            0.05305078 0.03439478  -0.07072394 -0.06033415 0.006648978
ACTUAL_ELAPSED_TIME 0.06086240 0.19037333  -0.04563512 -0.01602419 0.059612609
AIR_TIME            0.04836759 0.06952511  -0.07712053 -0.06518530 0.010649528
                        DISTANCE ACTUAL_ELAPSED_TIME    AIR_TIME
DEP_DELAY            0.053050775          0.06086240  0.04836759
ARR_DELAY            0.034394775          0.19037333  0.06952511
CRS_DEP_TIME        -0.070723941         -0.04563512 -0.07712053
WHEELS_OFF          -0.060334149         -0.01602419 -0.06518530
WHEELS_ON            0.006648978          0.05961261  0.01064953
DISTANCE             1.000000000          0.92985120  0.97898943
ACTUAL_ELAPSED_TIME  0.929851200          1.00000000  0.95219350
AIR_TIME             0.978989427          0.95219350  1.00000000</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>planes <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> OP_CARRIER, <span class="at">y =</span> WHEELS_OFF)) <span class="sc">+</span> </span>
<span id="cb15-3"><a href="#cb15-3"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>change_to_time <span class="ot">&lt;-</span> <span class="cf">function</span>(df, var_time){</span>
<span id="cb16-2"><a href="#cb16-2"></a>  df <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3"></a>    <span class="fu">mutate</span>({{var_time}} <span class="sc">:</span><span class="er">=</span> <span class="fu">sprintf</span>(<span class="st">"%04d"</span>, {{var_time}})) <span class="sc">%&gt;%</span></span>
<span id="cb16-4"><a href="#cb16-4"></a>    <span class="fu">mutate</span>({{var_time}} <span class="sc">:</span><span class="er">=</span> <span class="fu">format</span>(<span class="fu">strptime</span>({{var_time}}, <span class="at">format =</span><span class="st">"%H%M"</span>), <span class="at">format =</span> <span class="st">"%H:%M"</span>)) </span>
<span id="cb16-5"><a href="#cb16-5"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>value_count <span class="ot">&lt;-</span> <span class="cf">function</span>(data, group_col) {</span>
<span id="cb17-2"><a href="#cb17-2"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>    <span class="fu">count</span>({{group_col}}, <span class="at">name =</span> <span class="st">'count'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4"></a>    <span class="fu">mutate</span>(<span class="at">count =</span> <span class="fu">prop.table</span>(count) <span class="sc">*</span> <span class="dv">100</span>) </span>
<span id="cb17-5"><a href="#cb17-5"></a>}</span>
<span id="cb17-6"><a href="#cb17-6"></a></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="fu">value_count</span>(planes, OP_CARRIER)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   OP_CARRIER       count
1          9E  1.54185022
2          AA 16.91151554
3          B6  2.88934957
4          CO  3.65379632
5          DL 14.40688102
6          EV  0.17142743
7          F9  0.72457990
8          FL  5.93417984
9          MQ 11.26039030
10         NW  8.72485897
11         OH 11.12484302
12         OO  0.02691012
13         UA  6.55610262
14         US 12.73147687
15         WN  1.41726633
16         XE  0.88703730
17         YV  1.03753463</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># library(DataExplorer)</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co"># create_report(planes, y  = "DEP_DELAY")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>There is no month oktober in the dataset it seems as if september and oktober are taken together.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>planes <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="fu">group_by</span>(Month) <span class="sc">%&gt;%</span> </span>
<span id="cb20-3"><a href="#cb20-3"></a>  <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 2
# Groups:   Month [11]
   Month     n
   &lt;dbl&gt; &lt;int&gt;
 1     1  8677
 2     2  8052
 3     3  8885
 4     4  8381
 5     5  8496
 6     6  8523
 7     7  9005
 8     8  8847
 9     9 15874
10    11  7699
11    12  7895</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>planes <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2"></a>  <span class="fu">count</span>(Weekday, <span class="at">sort =</span> T) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Weekday     n
1    Monday 15772
2 Wednesday 15770
3   Tuesday 15668
4  Thursday 15535
5    Friday 15279
6    Sunday 13217
7  Saturday  9093</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="key-take-aways" class="level1">
<h1>Key take aways</h1>
<section id="problems-with-modelling-and-data" class="level2">
<h2 class="anchored" data-anchor-id="problems-with-modelling-and-data">Problems with modelling and data</h2>
</section>
<section id="interpretations-of-results" class="level2">
<h2 class="anchored" data-anchor-id="interpretations-of-results">Interpretations of results</h2>
</section>
</section>
<section id="modelling" class="level1">
<h1>Modelling</h1>
<section id="linear-model" class="level2">
<h2 class="anchored" data-anchor-id="linear-model">Linear Model</h2>
<p><strong>Short description of model:</strong></p>
<p><strong>What have we learned?:</strong></p>
</section>
<section id="glm-poisson" class="level2">
<h2 class="anchored" data-anchor-id="glm-poisson">GLM Poisson</h2>
<p><strong>Short description of model:</strong></p>
<p><strong>What have we learned?:</strong></p>
</section>
<section id="glm-binomial" class="level2">
<h2 class="anchored" data-anchor-id="glm-binomial">GLM Binomial</h2>
<p><strong>Short description of model:</strong></p>
<p><strong>What have we learned?:</strong></p>
</section>
<section id="gam" class="level2">
<h2 class="anchored" data-anchor-id="gam">GAM</h2>
<p><strong>Short description of model:</strong></p>
<p><strong>What have we learned?:</strong></p>
</section>
<section id="neural-network" class="level2">
<h2 class="anchored" data-anchor-id="neural-network">Neural Network</h2>
<p><strong>Short description of model:</strong></p>
<p><strong>What have we learned?:</strong></p>
</section>
<section id="support-vector-machine" class="level2">
<h2 class="anchored" data-anchor-id="support-vector-machine">Support Vector Machine</h2>
<p><strong>Short description of model:</strong></p>
<p><strong>What have we learned?:</strong></p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>